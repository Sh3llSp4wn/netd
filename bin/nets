#!/usr/bin/env ruby
# frozen_string_literal: true

require 'netd_core'
require 'logger'

def server_not_running
  raise 'server not running'
end

def check_connection(socket_path)
  begin
    UNIXSocket.open(socket_path).close
  rescue Errno::ECONNREFUSED
    false
  true
end

def main
  socket_path = "#{Dir.home}/.local/run/"
  server_not_running unless Dir.exist?(socket_path)
  socket_path += 'netd.socket'
  server_not_running unless check_connection(socket_path)

end

main
